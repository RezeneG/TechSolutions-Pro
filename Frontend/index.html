<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechSolutions Pro | Enhanced Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4361ee; --secondary: #3f37c9; --accent: #4cc9f0;
            --light: #f8f9fa; --dark: #212529; --success: #4bb543;
            --warning: #ffcc00; --danger: #dc3545; --gray: #6c757d;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #f5f7fb; color: var(--dark); }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        /* Header & Navigation */
        header { background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
        .logo { display: flex; align-items: center; gap: 10px; font-size: 1.5rem; font-weight: 700; color: var(--primary); }
        .nav-links { display: flex; gap: 30px; align-items: center; }
        .nav-links a { text-decoration: none; color: var(--dark); font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover { color: var(--primary); }
        
        /* Buttons */
        .btn { padding: 10px 20px; border-radius: 5px; font-weight: 600; cursor: pointer; transition: all 0.3s;
               border: none; text-decoration: none; display: inline-block; text-align: center; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--secondary); }
        .btn-outline { background: transparent; border: 2px solid var(--primary); color: var(--primary); }
        .btn-outline:hover { background: var(--primary); color: white; }
        .btn-small { padding: 8px 16px; font-size: 0.9rem; }
        
        /* Hero Section */
        .hero { padding: 80px 0; background: linear-gradient(135deg, #4361ee 0%, #3a0ca3 100%); color: white; text-align: center; }
        .hero h1 { font-size: 3rem; margin-bottom: 20px; }
        .hero p { font-size: 1.2rem; max-width: 700px; margin: 0 auto 30px; opacity: 0.9; }
        .hero-buttons { display: flex; gap: 15px; justify-content: center; margin-bottom: 50px; }
        .hero-stats { display: flex; justify-content: space-around; max-width: 800px; margin: 0 auto; 
                     background: rgba(255,255,255,0.1); padding: 30px; border-radius: 10px; backdrop-filter: blur(10px); }
        .stat { text-align: center; }
        .stat-number { font-size: 2.5rem; font-weight: 700; margin-bottom: 5px; }
        .stat-label { font-size: 1rem; opacity: 0.8; }
        
        /* Sections */
        .section { padding: 80px 0; }
        .section-header { text-align: center; margin-bottom: 50px; }
        .section-header h2 { font-size: 2.5rem; color: var(--dark); margin-bottom: 15px; }
        .section-header p { color: var(--gray); max-width: 600px; margin: 0 auto; }
        
        /* Filters & Search */
        .filters { display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
        .filter-btn { padding: 10px 20px; border: 2px solid var(--primary); background: white; color: var(--primary);
                     border-radius: 25px; cursor: pointer; transition: all 0.3s; font-weight: 600; }
        .filter-btn.active, .filter-btn:hover { background: var(--primary); color: white; }
        .search-box { display: flex; justify-content: center; margin-bottom: 30px; }
        .search-input { padding: 12px 20px; border: 2px solid var(--primary); border-radius: 25px; width: 100%; max-width: 400px; font-size: 1rem; }
        
        /* Grid Layout */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05);
                transition: transform 0.3s, box-shadow 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.1); }
        
        /* Service Cards */
        .service-icon { background: var(--primary); color: white; height: 80px; display: flex; align-items: center; justify-content: center; font-size: 2rem; }
        .service-content { padding: 25px; }
        .service-content h3 { margin-bottom: 15px; color: var(--dark); }
        .service-content p { color: var(--gray); margin-bottom: 20px; }
        .service-price { font-size: 1.5rem; font-weight: 700; color: var(--primary); margin-bottom: 15px; }
        .service-features { list-style: none; margin-bottom: 20px; }
        .service-features li { margin-bottom: 8px; display: flex; align-items: center; gap: 10px; }
        .service-features li i { color: var(--success); }
        
        /* Course Cards */
        .course-image { height: 180px; background: var(--primary); display: flex; align-items: center; justify-content: center; color: white; font-size: 3rem; position: relative; }
        .course-badge { position: absolute; top: 15px; right: 15px; background: var(--accent); color: white; padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: 600; }
        .course-content { padding: 25px; }
        .course-content h3 { margin-bottom: 15px; color: var(--dark); }
        .course-content p { color: var(--gray); margin-bottom: 20px; }
        .course-meta { display: flex; justify-content: space-between; margin-bottom: 20px; color: var(--gray); }
        .course-meta span { display: flex; align-items: center; gap: 5px; }
        .course-rating { color: var(--warning); }
        
        /* Admin Dashboard */
        .dashboard { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .dashboard-header { background: var(--primary); color: white; padding: 20px 30px; }
        .dashboard-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 30px; }
        .stat-card { background: var(--light); padding: 20px; border-radius: 8px; text-align: center; }
        .stat-card i { font-size: 2rem; color: var(--primary); margin-bottom: 10px; }
        .stat-card .number { font-size: 2rem; font-weight: 700; margin-bottom: 5px; }
        .stat-card .label { color: var(--gray); font-size: 0.9rem; }
        
        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1001; align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 30px; border-radius: 10px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; }
        .modal h3 { margin-bottom: 20px; color: var(--primary); }
        .close-modal { float: right; font-size: 1.5rem; cursor: pointer; color: var(--gray); }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; }
        .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 1rem; }
        
        /* User Auth */
        .user-menu { display: flex; align-items: center; gap: 15px; }
        .user-avatar { width: 40px; height: 40px; background: var(--primary); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        
        footer { background: var(--dark); color: white; padding: 60px 0 30px; }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 40px; }
        .footer-bottom { text-align: center; padding-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); }
        
        @media (max-width: 768px) {
            .navbar { flex-direction: column; gap: 20px; }
            .hero h1 { font-size: 2.2rem; }
            .hero-stats { flex-direction: column; gap: 30px; }
            .hero-buttons { flex-direction: column; align-items: center; }
            .filters { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">
                    <i class="fas fa-laptop-code"></i>
                    <span>TechSolutions Pro</span>
                </div>
                <div class="nav-links">
                    <a href="#" class="active">Home</a>
                    <a href="#services">Services</a>
                    <a href="#courses">Courses</a>
                    <a href="#admin" onclick="checkAdminAccess(event)">Admin</a>
                    <div class="user-menu" id="userMenu">
                        <a href="#" class="btn btn-outline" onclick="openModal('loginModal')">Login</a>
                        <a href="#" class="btn btn-primary" onclick="openModal('registerModal')">Sign Up</a>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="container">
            <h1>Professional IT Services & Training</h1>
            <p>Enhanced platform with user authentication, booking system, and advanced filtering</p>
            <div class="hero-buttons">
                <a href="#services" class="btn btn-primary">Explore Services</a>
                <a href="#courses" class="btn btn-outline">View Courses</a>
                <a href="#admin" class="btn btn-outline" onclick="checkAdminAccess(event)">Admin Dashboard</a>
            </div>
            <div class="hero-stats">
                <div class="stat">
                    <div class="stat-number">12</div>
                    <div class="stat-label">IT Services</div>
                </div>
                <div class="stat">
                    <div class="stat-number">9</div>
                    <div class="stat-label">Courses</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="totalUsers">1,247</div>
                    <div class="stat-label">Registered Users</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="section" id="services">
        <div class="container">
            <div class="section-header">
                <h2>Our Professional Services</h2>
                <p>Choose from 12 comprehensive IT services with advanced filtering</p>
            </div>
            
            <!-- Service Filters -->
            <div class="filters" id="serviceFilters">
                <button class="filter-btn active" data-category="all">All Services</button>
                <button class="filter-btn" data-category="development">Development</button>
                <button class="filter-btn" data-category="support">Support</button>
                <button class="filter-btn" data-category="testing">Testing</button>
                <button class="filter-btn" data-category="consultation">Consultation</button>
            </div>
            
            <!-- Service Search -->
            <div class="search-box">
                <input type="text" class="search-input" id="serviceSearch" placeholder="Search services...">
            </div>
            
            <div class="grid" id="services-container">
                <!-- Services loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Courses Section -->
    <section class="section" id="courses">
        <div class="container">
            <div class="section-header">
                <h2>Training Courses</h2>
                <p>9 comprehensive courses with category filtering and search</p>
            </div>
            
            <!-- Course Filters -->
            <div class="filters" id="courseFilters">
                <button class="filter-btn active" data-category="all">All Courses</button>
                <button class="filter-btn" data-category="web-dev">Web Development</button>
                <button class="filter-btn" data-category="security">Security</button>
                <button class="filter-btn" data-category="mobile">Mobile</button>
                <button class="filter-btn" data-category="data-science">Data Science</button>
                <button class="filter-btn" data-category="cloud">Cloud</button>
            </div>
            
            <!-- Course Search -->
            <div class="search-box">
                <input type="text" class="search-input" id="courseSearch" placeholder="Search courses...">
            </div>
            
            <div class="grid" id="courses-container">
                <!-- Courses loaded by JavaScript -->
            </div>
        </div>
    </section>

    <!-- Admin Dashboard -->
    <section class="section" id="admin" style="display: none;">
        <div class="container">
            <div class="section-header">
                <h2>Admin Dashboard</h2>
                <p>Platform management and analytics</p>
                <button class="btn btn-outline btn-small" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
            <div class="dashboard">
                <div class="dashboard-header">
                    <h3><i class="fas fa-chart-line"></i> Platform Analytics</h3>
                    <span id="adminWelcome">Welcome, Administrator</span>
                </div>
                <div class="dashboard-stats" id="admin-stats">
                    <!-- Admin stats loaded by JavaScript -->
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>TechSolutions Pro</h3>
                    <p>Your trusted partner for IT services and professional training.</p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="#services">Services</a></li>
                        <li><a href="#courses">Courses</a></li>
                        <li><a href="#admin" onclick="checkAdminAccess(event)">Admin</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Contact Us</h3>
                    <ul>
                        <li><i class="fas fa-envelope"></i> info@techsolutions.com</li>
                        <li><i class="fas fa-phone"></i> +44 123 456 7890</li>
                        <li><i class="fas fa-map-marker-alt"></i> London, UK</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 TechSolutions Pro. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('loginModal')">&times;</span>
            <h3><i class="fas fa-sign-in-alt"></i> Login</h3>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="loginEmail" placeholder="Enter your email" value="admin@techsolutions.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" placeholder="Enter your password" value="admin123">
            </div>
            <button class="btn btn-primary" onclick="login()" style="width: 100%;">Login</button>
            <p style="text-align: center; margin-top: 15px;">
                Don't have an account? <a href="#" onclick="closeModal('loginModal'); openModal('registerModal');" style="color: var(--primary);">Sign up</a>
            </p>
            <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                <small><strong>Demo Accounts:</strong><br>
                Admin: admin@techsolutions.com / admin123<br>
                User: user@example.com / user123</small>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('registerModal')">&times;</span>
            <h3><i class="fas fa-user-plus"></i> Create Account</h3>
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" id="registerName" placeholder="Enter your full name">
            </div>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="registerEmail" placeholder="Enter your email">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="registerPassword" placeholder="Create a password">
            </div>
            <button class="btn btn-primary" onclick="register()" style="width: 100%;">Create Account</button>
            <p style="text-align: center; margin-top: 15px;">
                Already have an account? <a href="#" onclick="closeModal('registerModal'); openModal('loginModal');" style="color: var(--primary);">Login</a>
            </p>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('adminLoginModal')">&times;</span>
            <h3><i class="fas fa-lock"></i> Admin Login</h3>
            <div class="form-group">
                <label>Email</label>
                <input type="email" id="adminEmail" value="admin@techsolutions.com">
            </div>
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="adminPassword" value="admin123">
            </div>
            <button class="btn btn-primary" onclick="adminLogin()" style="width: 100%;">
                <i class="fas fa-sign-in-alt"></i> Login to Admin Dashboard
            </button>
        </div>
    </div>

    <!-- Booking Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal('bookingModal')">&times;</span>
            <h3><i class="fas fa-calendar-check"></i> Book Service</h3>
            <div id="bookingServiceInfo"></div>
            <div class="form-group">
                <label>Preferred Date</label>
                <input type="date" id="bookingDate">
            </div>
            <div class="form-group">
                <label>Additional Notes</label>
                <textarea id="bookingNotes" placeholder="Any specific requirements..." rows="3"></textarea>
            </div>
            <button class="btn btn-primary" onclick="confirmBooking()" style="width: 100%;">Book Now</button>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = 'http://localhost:5000/api';
        
        // Application State
        let currentUser = null;
        let adminAuth = { isLoggedIn: false, user: null };
        let currentServiceForBooking = null;

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            loadServices();
            loadCourses();
            setupEventListeners();
            checkSavedAuth();
        });

        // Load Services with Filtering
        async function loadServices(category = 'all', search = '') {
            let url = `${API_BASE}/services`;
            const params = new URLSearchParams();
            if (category !== 'all') params.append('category', category);
            if (search) params.append('search', search);
            if (params.toString()) url += '?' + params.toString();

            try {
                const response = await fetch(url);
                const services = await response.json();
                displayServices(services);
            } catch (error) {
                console.error('Error loading services:', error);
                document.getElementById('services-container').innerHTML = '<p>Error loading services. Make sure backend is running.</p>';
            }
        }

        // Load Courses with Filtering
        async function loadCourses(category = 'all', search = '') {
            let url = `${API_BASE}/courses`;
            const params = new URLSearchParams();
            if (category !== 'all') params.append('category', category);
            if (search) params.append('search', search);
            if (params.toString()) url += '?' + params.toString();

            try {
                const response = await fetch(url);
                const courses = await response.json();
                displayCourses(courses);
            } catch (error) {
                console.error('Error loading courses:', error);
                document.getElementById('courses-container').innerHTML = '<p>Error loading courses. Make sure backend is running.</p>';
            }
        }

        // Display Services
        function displayServices(services) {
            const container = document.getElementById('services-container');
            container.innerHTML = '';

            services.forEach(service => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="service-icon">
                        <i class="fas fa-laptop-code"></i>
                    </div>
                    <div class="service-content">
                        <h3>${service.name}</h3>
                        <p>${service.description}</p>
                        ${service.features ? `
                            <ul class="service-features">
                                ${service.features.map(feature => `<li><i class="fas fa-check"></i> ${feature}</li>`).join('')}
                            </ul>
                        ` : ''}
                        <div class="service-price">${service.price}</div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="openBookingModal(${service.id})">Book Now</button>
                            <button class="btn btn-outline" onclick="viewServiceDetails(${service.id})">Details</button>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Display Courses
        function displayCourses(courses) {
            const container = document.getElementById('courses-container');
            container.innerHTML = '';

            courses.forEach(course => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="course-image">
                        <i class="fas fa-book"></i>
                        ${course.badge ? `<div class="course-badge">${course.badge}</div>` : ''}
                    </div>
                    <div class="course-content">
                        <h3>${course.name}</h3>
                        <p>${course.description}</p>
                        <div class="course-meta">
                            <span><i class="fas fa-clock"></i> ${course.duration}</span>
                            <span><i class="fas fa-user-graduate"></i> ${course.enrolled}</span>
                            <span class="course-rating"><i class="fas fa-star"></i> ${course.rating}</span>
                        </div>
                        <div style="margin-bottom: 15px; color: var(--gray); font-size: 0.9rem;">
                            <i class="fas fa-chalkboard-teacher"></i> ${course.instructor} • ${course.level}
                        </div>
                        <div class="service-price">${course.price}</div>
                        <button class="btn btn-primary" onclick="enrollInCourse(${course.id})">Enroll Now</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // Setup Event Listeners
        function setupEventListeners() {
            // Service Filters
            document.querySelectorAll('#serviceFilters .filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#serviceFilters .filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const category = btn.getAttribute('data-category');
                    const search = document.getElementById('serviceSearch').value;
                    loadServices(category, search);
                });
            });

            // Course Filters
            document.querySelectorAll('#courseFilters .filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('#courseFilters .filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const category = btn.getAttribute('data-category');
                    const search = document.getElementById('courseSearch').value;
                    loadCourses(category, search);
                });
            });

            // Search Functionality
            document.getElementById('serviceSearch').addEventListener('input', (e) => {
                const category = document.querySelector('#serviceFilters .filter-btn.active').getAttribute('data-category');
                loadServices(category, e.target.value);
            });

            document.getElementById('courseSearch').addEventListener('input', (e) => {
                const category = document.querySelector('#courseFilters .filter-btn.active').getAttribute('data-category');
                loadCourses(category, e.target.value);
            });
        }

        // User Authentication
        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const result = await response.json();
                
                if (result.success) {
                    currentUser = result.user;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    closeModal('loginModal');
                    updateUserInterface();
                    alert('Login successful!');
                } else {
                    alert('Login failed: ' + result.message);
                }
            } catch (error) {
                alert('Login error. Please try again.');
            }
        }

        async function register() {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;

            try {
                const response = await fetch(`${API_BASE}/auth/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password })
                });

                const result = await response.json();
                
                if (result.success) {
                    closeModal('registerModal');
                    alert('Registration successful! Please login.');
                    openModal('loginModal');
                } else {
                    alert('Registration failed: ' + result.message);
                }
            } catch (error) {
                alert('Registration error. Please try again.');
            }
        }

        // Admin Functions
        async function adminLogin() {
            const email = document.getElementById('adminEmail').value;
            const password = document.getElementById('adminPassword').value;

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const result = await response.json();
                
                if (result.success && result.user.role === 'admin') {
                    adminAuth = { isLoggedIn: true, user: result.user };
                    localStorage.setItem('adminAuth', JSON.stringify(adminAuth));
                    closeModal('adminLoginModal');
                    showAdminDashboard();
                    loadAdminStats();
                } else {
                    alert('Admin access denied. Please use admin credentials.');
                }
            } catch (error) {
                alert('Admin login error. Please try again.');
            }
        }

        function checkAdminAccess(event) {
            if (event) event.preventDefault();
            
            if (!adminAuth.isLoggedIn) {
                openModal('adminLoginModal');
            } else {
                showAdminDashboard();
            }
        }

        function showAdminDashboard() {
            document.getElementById('admin').style.display = 'block';
            document.getElementById('adminWelcome').textContent = `Welcome, ${adminAuth.user.name}`;
            document.getElementById('admin').scrollIntoView({ behavior: 'smooth' });
        }

        async function loadAdminStats() {
            try {
                const response = await fetch(`${API_BASE}/admin/dashboard`);
                const stats = await response.json();
                
                const container = document.getElementById('admin-stats');
                container.innerHTML = '';
                
                const statCards = [
                    { icon: 'fa-users', number: stats.totalUsers, label: 'Total Users' },
                    { icon: 'fa-laptop-code', number: stats.totalServices, label: 'Services' },
                    { icon: 'fa-book', number: stats.totalCourses, label: 'Courses' },
                    { icon: 'fa-calendar-check', number: stats.totalBookings, label: 'Bookings' },
                    { icon: 'fa-user-graduate', number: stats.totalEnrollments, label: 'Enrollments' },
                    { icon: 'fa-chart-line', number: stats.revenue, label: 'Revenue' }
                ];
                
                statCards.forEach(stat => {
                    const card = document.createElement('div');
                    card.className = 'stat-card';
                    card.innerHTML = `
                        <i class="fas ${stat.icon}"></i>
                        <div class="number">${stat.number}</div>
                        <div class="label">${stat.label}</div>
                    `;
                    container.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading admin stats:', error);
            }
        }

        // Booking System
        function openBookingModal(serviceId) {
            if (!currentUser) {
                alert('Please login to book services.');
                openModal('loginModal');
                return;
            }

            // In a real app, you would fetch service details
            currentServiceForBooking = serviceId;
            document.getElementById('bookingServiceInfo').innerHTML = `<p>Booking Service ID: ${serviceId}</p>`;
            openModal('bookingModal');
        }

        async function confirmBooking() {
            if (!currentUser || !currentServiceForBooking) return;

            const date = document.getElementById('bookingDate').value;
            const notes = document.getElementById('bookingNotes').value;

            try {
                const response = await fetch(`${API_BASE}/bookings`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        serviceId: currentServiceForBooking,
                        userId: currentUser.id,
                        date,
                        notes
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    closeModal('bookingModal');
                    alert('Booking confirmed successfully!');
                } else {
                    alert('Booking failed: ' + result.message);
                }
            } catch (error) {
                alert('Booking error. Please try again.');
            }
        }

        // Course Enrollment
        async function enrollInCourse(courseId) {
            if (!currentUser) {
                alert('Please login to enroll in courses.');
                openModal('loginModal');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/enrollments`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        courseId,
                        userId: currentUser.id
                    })
                });

                const result = await response.json();
                
                if (result.success) {
                    alert('Enrollment successful! Welcome to the course.');
                } else {
                    alert('Enrollment failed: ' + result.message);
                }
            } catch (error) {
                alert('Enrollment error. Please try again.');
            }
        }

        // Utility Functions
        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function updateUserInterface() {
            const userMenu = document.getElementById('userMenu');
            if (currentUser) {
                userMenu.innerHTML = `
                    <div class="user-avatar">${currentUser.name.charAt(0)}</div>
                    <span>${currentUser.name}</span>
                    <button class="btn btn-outline btn-small" onclick="logout()">Logout</button>
                `;
            } else {
                userMenu.innerHTML = `
                    <a href="#" class="btn btn-outline" onclick="openModal('loginModal')">Login</a>
                    <a href="#" class="btn btn-primary" onclick="openModal('registerModal')">Sign Up</a>
                `;
            }
        }

        function checkSavedAuth() {
            const savedUser = localStorage.getItem('currentUser');
            const savedAdmin = localStorage.getItem('adminAuth');
            
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserInterface();
            }
            
            if (savedAdmin) {
                adminAuth = JSON.parse(savedAdmin);
                if (adminAuth.isLoggedIn) {
                    showAdminDashboard();
                    loadAdminStats();
                }
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            updateUserInterface();
            alert('Logged out successfully.');
        }

        function adminLogout() {
            adminAuth = { isLoggedIn: false, user: null };
            localStorage.removeItem('adminAuth');
            document.getElementById('admin').style.display = 'none';
            alert('Admin logged out.');
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
    </script>
</body>
</html>

